package com.securityai.scanner;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.util.ArrayList;
import java.util.List;

public class VulnerabilityScanner {

    public List<Integer> scanOpenPorts(String host, int startPort, int endPort, int timeoutMillis) {
        List<Integer> openPorts = new ArrayList<>();

        for (int port = startPort; port <= endPort; port++) {
            try (Socket socket = new Socket()) {
                socket.connect(new InetSocketAddress(host, port), timeoutMillis);
                openPorts.add(port);
                System.out.println("Port " + port + " is OPEN on " + host);
            } catch (IOException e) {
                // Port closed or unreachable, do nothing
            }
        }

        return openPorts;
    }
}
